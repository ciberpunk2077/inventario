<!-- <p>producto-form works!</p>

<div class="container mt-4">
    <h3>{{ editando ? '✏️ Editar Producto' : '➕ Nuevo Producto' }}</h3>

    <form (ngSubmit)="guardar()" enctype="multipart/form-data">

        <div class="mb-3">
            <label class="form-label">Código de barras</label>
            <input class="form-control" [(ngModel)]="producto.codigo_barras" name="codigo_barras">
        </div>

        <div class="mb-3">
            <label class="form-label">Nombre *</label>
            <input class="form-control" [(ngModel)]="producto.nombre" name="nombre" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Descripción</label>
            <textarea class="form-control" [(ngModel)]="producto.descripcion" name="descripcion"></textarea>
        </div>

        <div class="row">
            <div class="col">
                <label>Categoría *</label>
                <select class="form-select" [(ngModel)]="producto.categoria" name="categoria" required>
                    <option [ngValue]="null">Seleccione</option>
                    <option *ngFor="let c of categorias" [value]="c.id_categoria">
                        {{ c.nombre }}
                    </option>
                </select>
            </div>

            <div class="col">
                <label>Proveedor</label>
                <select class="form-select" [(ngModel)]="producto.proveedor" name="proveedor">
                    <option [ngValue]="null">Seleccione</option>
                    <option *ngFor="let p of proveedores" [value]="p.id_proveedor">
                        {{ p.nombre }}
                    </option>
                </select>
            </div>

            <div class="col">
                <label>Marca</label>
                <select class="form-select" [(ngModel)]="producto.marca" name="marca">
                    <option [ngValue]="null">Seleccione</option>
                    <option *ngFor="let m of marcas" [value]="m.id_marca">
                        {{ m.nombre }}
                    </option>
                </select>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col">
                <label>Precio compra *</label>
                <input type="number" class="form-control" [(ngModel)]="producto.precio_compra" name="precio_compra"
                    required>
            </div>

            <div class="col">
                <label>Precio venta *</label>
                <input type="number" class="form-control" [(ngModel)]="producto.precio_venta" name="precio_venta"
                    required>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col">
                <label>Stock mínimo</label>
                <input type="number" class="form-control" [(ngModel)]="producto.stock_minimo" name="stock_minimo">
            </div>

            <div class="col">
                <label>Stock máximo</label>
                <input type="number" class="form-control" [(ngModel)]="producto.stock_maximo" name="stock_maximo">
            </div>

            <div class="col">
                <label>Unidad</label>
                <select class="form-select" [(ngModel)]="producto.unidad_medida" name="unidad_medida">
                    <option *ngFor="let u of unidades" [value]="u.value">
                        {{ u.label }}
                    </option>
                </select>
            </div>
        </div>

        <div class="mt-3">
            <label>Imagen</label>
            <input type="file" class="form-control" (change)="onFileChange($event)">
        </div>

        <div *ngIf="imagenPreview" class="mt-2">
            <img [src]="imagenPreview" width="120" class="img-thumbnail">
        </div>

        <div *ngIf="errorMsg" class="alert alert-danger mt-3">
            {{ errorMsg }}
        </div>

        <button class="btn btn-success mt-3">
            {{ editando ? 'Guardar cambios' : 'Crear producto' }}
        </button>

        <button type="button" class="btn btn-secondary mt-3 ms-2" (click)="cancelar()">
            Cancelar
        </button>

    </form>
</div> -->

<div class="container mt-5">
    <div class="card shadow-lg border-0 product-card">

        <!-- Header -->
        <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
                <i class="fas fa-box me-2"></i>
                {{ editando ? 'Editar Producto' : 'Nuevo Producto' }}
            </h5>

            <span class="badge bg-secondary">
                {{ editando ? 'Edición' : 'Registro' }}
            </span>
        </div>

        <!-- Body -->
        <div class="card-body p-4">

            <div class="form-layout">
                <div class="image-column">

                    <div class="image-frame">
                        <img *ngIf="imagenPreview; else placeholder" [src]="imagenPreview"
                            alt="Vista previa del producto">

                        <ng-template #placeholder>
                            <div class="image-placeholder">
                                <i class="fas fa-image"></i>
                                <span>Sin imagen</span>
                            </div>
                        </ng-template>
                    </div>

                    <input type="file" class="form-control mt-2" (change)="onFileChange($event)">
                </div>


                <form (ngSubmit)="guardar()" enctype="multipart/form-data">

                    <!-- Básico -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label">Código de barras</label>
                            <input class="form-control" placeholder="Ej: 7501234567890"
                                [(ngModel)]="producto.codigo_barras" name="codigo_barras">
                        </div>

                        <div class="col-md-8">
                            <label class="form-label">Nombre del producto *</label>
                            <input class="form-control" placeholder="Ej: Teclado mecánico RGB"
                                [(ngModel)]="producto.nombre" name="nombre" required>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Descripción</label>
                        <textarea class="form-control" rows="3" placeholder="Descripción breve del producto..."
                            [(ngModel)]="producto.descripcion" name="descripcion"></textarea>
                    </div>

                    <!-- Relaciones -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label>Categoría *</label>
                            <select class="form-select" [(ngModel)]="producto.categoria" name="categoria" required>
                                <option [ngValue]="null">Seleccione categoría</option>
                                <option *ngFor="let c of categorias" [value]="c.id_categoria">
                                    {{ c.nombre }}
                                </option>
                            </select>
                        </div>

                        <div class="col-md-4">
                            <label>Proveedor</label>
                            <select class="form-select" [(ngModel)]="producto.proveedor" name="proveedor">
                                <option [ngValue]="null">Seleccione proveedor</option>
                                <option *ngFor="let p of proveedores" [value]="p.id_proveedor">
                                    {{ p.nombre }}
                                </option>
                            </select>
                        </div>

                        <div class="col-md-4">
                            <label>Marca</label>
                            <select class="form-select" [(ngModel)]="producto.marca" name="marca">
                                <option [ngValue]="null">Seleccione marca</option>
                                <option *ngFor="let m of marcas" [value]="m.id_marca">
                                    {{ m.nombre }}
                                </option>
                            </select>
                        </div>
                    </div>

                    <!-- Precios -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label>Precio de compra *</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" [(ngModel)]="producto.precio_compra"
                                    name="precio_compra" required>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>Precio de venta *</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" [(ngModel)]="producto.precio_venta"
                                    name="precio_venta" required>
                            </div>
                        </div>
                    </div>

                    <!-- Stock -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label>Stock mínimo</label>
                            <input type="number" class="form-control" [(ngModel)]="producto.stock_minimo"
                                name="stock_minimo">
                        </div>

                        <div class="col-md-4">
                            <label>Stock máximo</label>
                            <input type="number" class="form-control" [(ngModel)]="producto.stock_maximo"
                                name="stock_maximo">
                        </div>

                        <div class="col-md-4">
                            <label>Unidad</label>
                            <select class="form-select" [(ngModel)]="producto.unidad_medida" name="unidad_medida">
                                <option *ngFor="let u of unidades" [value]="u.value">
                                    {{ u.label }}
                                </option>
                            </select>
                        </div>
                    </div>


                    <!-- Error -->
                    <div *ngIf="errorMsg" class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        {{ errorMsg }}
                    </div>

                    <!-- Acciones -->
                    <div class="d-flex justify-content-end gap-2 mt-4">
                        <button type="button" class="btn btn-outline-secondary" (click)="cancelar()">
                            <i class="fas fa-times me-1"></i> Cancelar
                        </button>

                        <button class="btn btn-success px-4">
                            <i class="fas fa-save me-1"></i>
                            {{ editando ? 'Guardar cambios' : 'Crear producto' }}
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>